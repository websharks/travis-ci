#!/usr/bin/env bash

# Install from Ondrej's PPA.
# See: <https://launchpad.net/~ondrej/+archive/ubuntu/php-7.0>

add-apt-repository ppa:ondrej/php --yes;
apt-get update; # Update after adding PPA.

apt-get install php7.0-cli --yes;
apt-get install php7.0-fpm --yes;

apt-get install php7.0-mysql --yes;
apt-get install php7.0-curl --yes;
apt-get install php7.0-intl --yes;
apt-get install php7.0-pspell --yes;
apt-get install php7.0-gmp --yes;
apt-get install php7.0-bz2 --yes;
apt-get install php7.0-gd --yes;
apt-get install php7.0-mcrypt --yes;
apt-get install php-memcached --yes;
apt-get install php7.0-mbstring --yes;
apt-get install php7.0-xml --yes;
apt-get install php7.0-zip --yes;
apt-get install php7.0-bcmath --yes;

## Create PHP config file symlink.

ln --symbolic /bootstrap/src/php/.ini /etc/php/7.0/cli/conf.d/z90.ini;

## Create PHP config file symlinks & restart service.

ln --symbolic /bootstrap/src/php/.ini /etc/php/7.0/fpm/conf.d/z90.ini;

mv /etc/php/7.0/fpm/pool.d/www.conf /etc/php/7.0/fpm/pool.d/www.conf~;
ln --symbolic /bootstrap/src/php/fpm/.conf /etc/php/7.0/fpm/pool.d/z90.conf;

service php7.0-fpm restart;
